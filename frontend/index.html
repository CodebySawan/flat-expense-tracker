<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flat Expense Tracker</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-flex">
        <div>
          <h1>🏠 Flat Expense Tracker</h1>
          <p>Kartik • Akshay • Prince • Sawan • Krishna</p>
        </div>
        <div class="header-actions">
          <button class="btn-refresh" id="refreshBtn" title="Refresh data">🔄</button>
          <button class="btn-admin" id="adminBtn">🔐 Admin</button>
          <span class="admin-indicator" id="adminIndicator" style="display:none;">Admin Mode</span>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    
    <!-- Turn Trackers Section -->
    <section class="turns-section">
      
      <!-- Vegetable Turn -->
      <div class="turn-card veg-card">
        <div class="turn-header">
          <h2>🥬 Vegetable Turn</h2>
        </div>
        <div class="turn-content">
          <div class="current-person" id="vegCurrentPerson">
            <span class="person-name">Loading...</span>
          </div>
          <button class="btn btn-primary" id="addVegExpenseBtn">Add Vegetable Expense</button>
        </div>
      </div>

      <!-- Water Tank Turn -->
      <div class="turn-card water-card">
        <div class="turn-header">
          <h2>💧 Water Tank Turn</h2>
        </div>
        <div class="turn-content">
          <div class="current-person" id="waterCurrentPerson">
            <span class="person-name">Loading...</span>
          </div>
          <div class="cans-count" id="waterCansCount">
            <span class="can" id="can1">🪣</span>
            <span class="can" id="can2">🪣</span>
          </div>
          <button class="btn btn-secondary" id="fillWaterBtn">Fill Can</button>
        </div>
      </div>

    </section>

    <!-- Add Custom Expense Button -->
    <section class="actions-section">
      <button class="btn btn-accent" id="addCustomExpenseBtn">➕ Add Custom Expense (Milk, etc.)</button>
    </section>

    <!-- Admin Settlement Button (Only visible in admin mode) -->
    <section class="admin-section" id="adminSection" style="display:none;">
      <button class="btn btn-warning" id="settleUpBtn">💰 Settle Up Now</button>
    </section>

    <!-- Diary Section -->
    <section class="diary-section">
      <h2>📔 Diary (Khata)</h2>
      
      <div class="person-selector">
        <label>Select Person:</label>
        <select id="diaryPersonSelect">
          <option value="">-- Select --</option>
        </select>
      </div>

      <div id="diaryContent" class="diary-content">
        <div class="empty-state">Select a person to view their diary</div>
      </div>
    </section>

    <!-- Current Expenses Section -->
    <section class="summary-section">
      <h2>📊 Current Expenses</h2>
      <div id="currentExpensesList" class="expenses-list">
        <!-- Expenses will be loaded here -->
      </div>
    </section>

    <!-- Settlement History Section -->
    <section class="summary-section">
      <h2>📜 Settlement History</h2>
      <div id="settlementHistoryList" class="history-list">
        <!-- History will be loaded here -->
      </div>
    </section>

  </main>

  <!-- Admin Login Modal -->
  <div class="modal" id="adminLoginModal">
    <div class="modal-content modal-small">
      <span class="close" id="closeAdminModal">&times;</span>
      <h2>🔐 Admin Login</h2>
      <form id="adminLoginForm">
        <div class="form-group">
          <label>Password:</label>
          <input type="password" id="adminPassword" placeholder="Enter admin password" required>
        </div>
        <button type="submit" class="btn btn-primary">Login</button>
      </form>
    </div>
  </div>

  <!-- Modal for Adding Vegetable Expense -->
  <div class="modal" id="vegExpenseModal">
    <div class="modal-content">
      <span class="close" id="closeVegModal">&times;</span>
      <h2>Add Vegetable Expense</h2>
      <form id="vegExpenseForm">
        <div class="form-group">
          <label>Paid By:</label>
          <input type="text" id="vegPersonName" readonly>
        </div>
        <div class="form-group">
          <label>Amount (₹):</label>
          <input type="number" id="vegAmount" placeholder="500" required>
        </div>
        <div class="form-group">
          <label>Description:</label>
          <input type="text" id="vegDescription" placeholder="Vegetables from market" required>
        </div>
        <div class="form-group">
          <label>Shared By (select people):</label>
          <div id="vegSharedByCheckboxes" class="checkbox-group">
            <!-- Checkboxes loaded dynamically -->
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Add Expense</button>
      </form>
    </div>
  </div>

  <!-- Modal for Adding Custom Expense -->
  <div class="modal" id="customExpenseModal">
    <div class="modal-content">
      <span class="close" id="closeCustomModal">&times;</span>
      <h2>Add Custom Expense</h2>
      <form id="customExpenseForm">
        <div class="form-group">
          <label>Paid By:</label>
          <select id="customPaidBy" required>
            <!-- Options loaded dynamically -->
          </select>
        </div>
        <div class="form-group">
          <label>Amount (₹):</label>
          <input type="number" id="customAmount" placeholder="40" required>
        </div>
        <div class="form-group">
          <label>Description:</label>
          <input type="text" id="customDescription" placeholder="Milk" required>
        </div>
        <div class="form-group">
          <label>Shared By (select people who used it):</label>
          <div id="sharedByCheckboxes" class="checkbox-group">
            <!-- Checkboxes loaded dynamically -->
          </div>
        </div>
        <button type="submit" class="btn btn-accent">Add Expense</button>
      </form>
    </div>
  </div>

  <!-- Settlement Modal -->
  <div class="modal" id="settlementModal">
    <div class="modal-content modal-large">
      <span class="close" id="closeSettlementModal">&times;</span>
      <h2>💰 Settlement Summary</h2>
      
      <div id="settlementSummary">
        <!-- Settlement details will be loaded here -->
      </div>

      <div class="settlement-actions">
        <button class="btn btn-success" id="markSettledBtn">✅ Mark as Settled</button>
        <button class="btn btn-secondary" id="cancelSettlementBtn">Cancel</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>